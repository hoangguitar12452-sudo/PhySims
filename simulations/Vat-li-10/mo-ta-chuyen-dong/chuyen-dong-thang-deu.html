<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DePhys - Mô phỏng Chuyển động thẳng đều</title>

    <!-- Tải React và ReactDOM -->
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>

    <!-- Tải Babel để xử lý JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Tải Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font chữ Inter & JetBrains Mono -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;700&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: "Inter", sans-serif;
      }
      .font-mono {
        font-family: "JetBrains Mono", monospace;
      }
      /* Tinh chỉnh thanh cuộn */
      ::-webkit-scrollbar {
        width: 6px;
        height: 6px;
      }
      ::-webkit-scrollbar-track {
        background: #f1f5f9;
      }
      ::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #94a3b8;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect, useRef, useCallback, useLayoutEffect } =
        React;

      // --- CÁC ICON SVG ---
      const IconPlay = ({ className }) => (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          strokeWidth="2"
          strokeLinecap="round"
          strokeLinejoin="round"
          className={className}
        >
          <polygon points="5 3 19 12 5 21 5 3" />
        </svg>
      );
      const IconPause = ({ className }) => (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          strokeWidth="2"
          strokeLinecap="round"
          strokeLinejoin="round"
          className={className}
        >
          <rect x="6" y="4" width="4" height="16" />
          <rect x="14" y="4" width="4" height="16" />
        </svg>
      );
      const IconRotateCcw = ({ className }) => (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          strokeWidth="2"
          strokeLinecap="round"
          strokeLinejoin="round"
          className={className}
        >
          <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" />
          <path d="M3 3v5h5" />
        </svg>
      );
      const IconSettings = ({ className }) => (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          strokeWidth="2"
          strokeLinecap="round"
          strokeLinejoin="round"
          className={className}
        >
          <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.51a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" />
          <circle cx="12" cy="12" r="3" />
        </svg>
      );
      const IconActivity = ({ className }) => (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          strokeWidth="2"
          strokeLinecap="round"
          strokeLinejoin="round"
          className={className}
        >
          <polyline points="22 12 18 12 15 21 9 3 6 12 2 12" />
        </svg>
      );
      const IconInfo = ({ className }) => (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          strokeWidth="2"
          strokeLinecap="round"
          strokeLinejoin="round"
          className={className}
        >
          <circle cx="12" cy="12" r="10" />
          <line x1="12" y1="16" x2="12" y2="12" />
          <line x1="12" y1="8" x2="12.01" y2="8" />
        </svg>
      );

      // --- HOOK TỰ ĐỘNG ĐO KÍCH THƯỚC CONTAINER ---
      const useContainerSize = () => {
        const ref = useRef(null);
        const [size, setSize] = useState({ width: 0, height: 0 });

        useLayoutEffect(() => {
          const element = ref.current;
          if (!element) return;

          const observer = new ResizeObserver((entries) => {
            for (let entry of entries) {
              setSize({
                width: entry.contentRect.width,
                height: entry.contentRect.height,
              });
            }
          });

          observer.observe(element);
          return () => observer.disconnect();
        }, []);

        return [ref, size];
      };

      // --- ỨNG DỤNG CHÍNH ---
      const UniformMotionSim = () => {
        // State
        const [x0, setX0] = useState(0);
        const [v, setV] = useState(5);
        const [t, setT] = useState(0);
        const [currentX, setCurrentX] = useState(0); // State riêng cho X hiện tại
        const [isPlaying, setIsPlaying] = useState(false);
        const [history, setHistory] = useState([]);

        // Refs quản lý vật lý
        const physicsRef = useRef({ t: 0, x: 0 });

        const [roadContainerRef, roadSize] = useContainerSize();
        const [graphContainerRef, graphSize] = useContainerSize();
        const roadCanvasRef = useRef(null);
        const graphCanvasRef = useRef(null);

        const requestRef = useRef();
        const previousTimeRef = useRef();

        const SCALE = 20;
        const DT = 0.02;

        // --- Reset ---
        const handleReset = useCallback(
          (newStartPos = null) => {
            const startX = newStartPos !== null ? newStartPos : x0;

            setIsPlaying(false);
            setT(0);
            setCurrentX(startX);
            setHistory([]);

            // Reset trạng thái vật lý
            physicsRef.current = { t: 0, x: startX };

            if (requestRef.current) cancelAnimationFrame(requestRef.current);
            previousTimeRef.current = undefined;
          },
          [x0]
        );

        // --- Animation Loop ---
        const animate = useCallback(
          (time) => {
            if (previousTimeRef.current !== undefined) {
              // 1. Tính toán vật lý trên Ref
              const prevX = physicsRef.current.x;
              const nextT = physicsRef.current.t + DT;
              const nextX = prevX + v * DT;

              // 2. Kiểm tra biên
              const dynamicBoundary =
                (roadSize.width > 0 ? roadSize.width / 2 / SCALE : 20) + 2;
              const limit = dynamicBoundary > 2 ? dynamicBoundary : 22;

              if (Math.abs(nextX) > limit) {
                setIsPlaying(false);
                return;
              }

              // 3. Cập nhật Ref
              physicsRef.current.t = nextT;
              physicsRef.current.x = nextX;

              // 4. Đồng bộ ra State
              setT(nextT);
              setCurrentX(nextX);
              setHistory((prevHistory) => {
                if (prevHistory.length > 2500) return prevHistory;
                return [...prevHistory, { t: nextT, x: nextX }];
              });
            }
            previousTimeRef.current = time;
            requestRef.current = requestAnimationFrame(animate);
          },
          [v, roadSize.width]
        );

        // --- Effects ---

        // Khởi tạo vị trí ban đầu khi load
        useEffect(() => {
          if (history.length === 0 && t === 0) {
            setCurrentX(x0);
            physicsRef.current.x = x0;
          }
        }, []);

        // Loop quản lý
        useEffect(() => {
          if (isPlaying) {
            requestRef.current = requestAnimationFrame(animate);
          } else {
            cancelAnimationFrame(requestRef.current);
            previousTimeRef.current = undefined;
          }
          return () => cancelAnimationFrame(requestRef.current);
        }, [isPlaying, animate]);

        // Xử lý Input
        const onX0Change = (e) => {
          const val = Number(e.target.value);
          setX0(val);
          handleReset(val);
        };

        const onVChange = (e) => {
          const val = Number(e.target.value);
          setV(val);
        };

        // --- VẼ CANVAS 1: ĐƯỜNG ĐI ---
        useEffect(() => {
          const canvas = roadCanvasRef.current;
          if (!canvas || roadSize.width === 0) return;

          canvas.width = roadSize.width;
          canvas.height = roadSize.height;

          const ctx = canvas.getContext("2d");
          const width = canvas.width;
          const height = canvas.height;

          ctx.clearRect(0, 0, width, height);
          ctx.fillStyle = "#f8fafc";
          ctx.fillRect(0, 0, width, height);

          const roadY = height / 2 + 20;
          const originX = width / 2;

          // Đường
          ctx.fillStyle = "#e2e8f0";
          ctx.fillRect(0, roadY, width, 4);

          ctx.font = "10px Inter, sans-serif";
          ctx.textAlign = "center";

          const maxMetersVisible = Math.ceil(width / 2 / SCALE) + 2;

          for (let i = -maxMetersVisible; i <= maxMetersVisible; i++) {
            const xPos = originX + i * SCALE;
            ctx.beginPath();
            if (i % 5 === 0) {
              ctx.strokeStyle = "#64748b";
              ctx.lineWidth = 2;
              ctx.moveTo(xPos, roadY);
              ctx.lineTo(xPos, roadY + 8);
              ctx.fillStyle = "#64748b";
              ctx.fillText(i + "m", xPos, roadY + 22);
            } else {
              ctx.strokeStyle = "#94a3b8";
              ctx.lineWidth = 1;
              ctx.moveTo(xPos, roadY);
              ctx.lineTo(xPos, roadY + 4);
            }
            ctx.stroke();
          }

          // Gốc O
          ctx.beginPath();
          ctx.strokeStyle = "#ef4444";
          ctx.lineWidth = 2;
          ctx.moveTo(originX, roadY - 15);
          ctx.lineTo(originX, roadY + 15);
          ctx.stroke();
          ctx.fillStyle = "#ef4444";
          ctx.font = "bold 12px Inter, sans-serif";
          ctx.fillText("O", originX, roadY - 20);

          // Xe
          const carX = originX + currentX * SCALE;
          const carY = roadY - 2;

          ctx.save();
          ctx.translate(carX, carY);
          if (v < 0) ctx.scale(-1, 1);

          ctx.fillStyle = "#2563eb";
          ctx.beginPath();
          ctx.roundRect(-20, -12, 40, 12, [2, 2, 0, 0]);
          ctx.fill();
          ctx.fillStyle = "#60a5fa";
          ctx.beginPath();
          ctx.roundRect(-10, -20, 20, 10, [4, 4, 0, 0]);
          ctx.fill();
          ctx.fillStyle = "#1e293b";
          ctx.beginPath();
          ctx.arc(-12, 0, 5, 0, Math.PI * 2);
          ctx.arc(12, 0, 5, 0, Math.PI * 2);
          ctx.fill();
          ctx.fillStyle = "#94a3b8";
          ctx.beginPath();
          ctx.arc(-12, 0, 2, 0, Math.PI * 2);
          ctx.arc(12, 0, 2, 0, Math.PI * 2);
          ctx.fill();
          ctx.restore();

          // Vector vận tốc
          if (v !== 0) {
            const arrowLen = Math.abs(v) * 4 + 20;
            const arrowY = roadY - 35;
            const dir = v > 0 ? 1 : -1;

            ctx.beginPath();
            ctx.strokeStyle = "#dc2626";
            ctx.lineWidth = 2;
            ctx.moveTo(carX, arrowY);
            ctx.lineTo(carX + arrowLen * dir, arrowY);
            const headSize = 6;
            ctx.lineTo(
              carX + arrowLen * dir - headSize * dir,
              arrowY - headSize
            );
            ctx.moveTo(carX + arrowLen * dir, arrowY);
            ctx.lineTo(
              carX + arrowLen * dir - headSize * dir,
              arrowY + headSize
            );
            ctx.stroke();
            ctx.fillStyle = "#dc2626";
            ctx.font = "bold 11px Inter, sans-serif";
            ctx.fillText(`v = ${v} m/s`, carX, arrowY - 8);
          }

          // Cảnh báo vùng hiển thị
          const visualLimitMeter = width / 2 / SCALE;
          if (Math.abs(currentX) > visualLimitMeter) {
            ctx.fillStyle = "rgba(239, 68, 68, 0.1)";
            ctx.fillRect(0, 0, width, height);
            ctx.textAlign = "center";
            if (isPlaying) {
              ctx.fillStyle = "#ef4444";
              ctx.font = "italic 12px Inter, sans-serif";
              ctx.fillText("Sắp ra khỏi vùng hiển thị...", width / 2, 20);
            } else {
              ctx.fillStyle = "#dc2626";
              ctx.font = "bold 14px Inter, sans-serif";
              ctx.fillText("Đã ra khỏi vùng hiển thị", width / 2, 30);
            }
          }
        }, [currentX, v, isPlaying, roadSize]);

        // --- VẼ CANVAS 2: ĐỒ THỊ (TRƯỢT ĐỐI XỨNG - CENTERED DOT) ---
        useEffect(() => {
          const canvas = graphCanvasRef.current;
          if (!canvas || graphSize.width === 0) return;

          canvas.width = graphSize.width;
          canvas.height = graphSize.height;

          const ctx = canvas.getContext("2d");
          const width = canvas.width;
          const height = canvas.height;

          const isSmallWidth = width < 480;
          const isSmallHeight = height < 300;

          const padding = {
            left: isSmallWidth ? 35 : 50,
            right: 30,
            top: isSmallHeight ? 15 : 20,
            bottom: isSmallHeight ? 25 : 40,
          };

          const graphW = width - padding.left - padding.right;
          const graphH = height - padding.top - padding.bottom;

          const originGraphX = padding.left;

          // --- 1. TÍNH TOÁN SCROLL NGANG (TRỤC T) ---
          const TIME_WINDOW = isSmallWidth ? 10 : 20;
          // Khi t > 1/2 khung hình, bắt đầu trượt để giữ t ở giữa
          let viewStartT = 0;
          if (t > TIME_WINDOW / 2) {
            viewStartT = t - TIME_WINDOW / 2;
          }
          const pxPerSec = graphW / TIME_WINDOW;

          // --- 2. TÍNH TOÁN SCROLL DỌC (TRỤC X - CENTERED) ---
          const MAX_X_HALF_RANGE = 15; // Phạm vi hiển thị mặc định (+/- 15m)
          const pxPerMeter = graphH / 2 / MAX_X_HALF_RANGE;

          // Để giữ chấm tròn ở giữa (chiều cao), tâm đồ thị phải là currentX
          const viewCenterVal = currentX;

          // Tính vị trí Y của giá trị 0 (Gốc O) dựa trên viewCenterVal
          // Tại trung tâm canvas (height/2), giá trị là viewCenterVal
          // => originGraphY (giá trị 0) sẽ nằm lệch đi một đoạn tương ứng
          const originGraphY = height / 2 + viewCenterVal * pxPerMeter;

          ctx.clearRect(0, 0, width, height);

          // --- VẼ LƯỚI ---
          ctx.beginPath();
          ctx.strokeStyle = "#f1f5f9";
          ctx.lineWidth = 1;

          // Lưới dọc (Thời gian)
          const startGridT = Math.floor(viewStartT / 2) * 2;
          for (let i = startGridT; i <= viewStartT + TIME_WINDOW; i += 2) {
            if (i < viewStartT) continue;
            const x = originGraphX + (i - viewStartT) * pxPerSec;
            if (x > originGraphX + graphW) continue;

            ctx.moveTo(x, padding.top);
            ctx.lineTo(x, height - padding.bottom);

            ctx.save();
            ctx.fillStyle = "#64748b";
            ctx.font = "10px Inter, sans-serif";
            ctx.textAlign = "center";
            ctx.fillText(i, x, height - 5);
            ctx.restore();
          }

          // Lưới ngang (Toạ độ X) - Vẽ động xung quanh viewCenterVal
          const startGridX =
            Math.floor((viewCenterVal - MAX_X_HALF_RANGE) / 5) * 5;
          const endGridX =
            Math.ceil((viewCenterVal + MAX_X_HALF_RANGE) / 5) * 5;

          for (let j = startGridX; j <= endGridX; j += 5) {
            const y = originGraphY - j * pxPerMeter;

            if (y < padding.top || y > height - padding.bottom) continue;

            ctx.moveTo(originGraphX, y);
            ctx.lineTo(width - padding.right, y);

            if (j !== 0) {
              ctx.save();
              ctx.fillStyle = "#64748b";
              ctx.textAlign = "right";
              ctx.fillText(j, originGraphX - 8, y + 4);
              ctx.restore();
            }
          }
          ctx.stroke();

          // --- VẼ TRỤC CHÍNH ---
          ctx.beginPath();
          ctx.strokeStyle = "#334155";
          ctx.lineWidth = 1.5;

          // Trục thời gian (Ngang - tại x=0)
          if (
            originGraphY >= padding.top &&
            originGraphY <= height - padding.bottom
          ) {
            ctx.moveTo(originGraphX, originGraphY);
            ctx.lineTo(width - padding.right, originGraphY);
          }

          // Trục toạ độ (Dọc - tại t=0?) - Vẽ cố định bên trái
          ctx.moveTo(originGraphX, height - padding.bottom);
          ctx.lineTo(originGraphX, padding.top);
          ctx.stroke();

          // Labels
          ctx.fillStyle = "#1e293b";
          ctx.font = "bold 12px Inter, sans-serif";
          ctx.textAlign = "right";

          // Chữ t(s) di chuyển theo trục t hoặc ghim đáy
          if (
            originGraphY >= padding.top &&
            originGraphY <= height - padding.bottom
          ) {
            ctx.fillText("t (s)", width - padding.right, originGraphY - 6);
            ctx.textAlign = "left";
            ctx.fillText("O", originGraphX - 15, originGraphY + 15);
          } else {
            ctx.fillText(
              "t (s)",
              width - padding.right,
              height - padding.bottom - 6
            );
          }

          ctx.textAlign = "left";
          ctx.fillText("x (m)", originGraphX + 6, padding.top + 10);

          // --- VẼ ĐƯỜNG ĐỒ THỊ ---
          ctx.save();
          ctx.beginPath();
          ctx.rect(padding.left, padding.top, graphW, graphH);
          ctx.clip();

          if (history.length > 0) {
            ctx.beginPath();
            ctx.strokeStyle = "#2563eb";
            ctx.lineWidth = 2.5;

            let hasStarted = false;
            for (let i = 0; i < history.length; i++) {
              const p = history[i];
              if (p.t < viewStartT - DT * 5) continue;

              const px = originGraphX + (p.t - viewStartT) * pxPerSec;
              const py = originGraphY - p.x * pxPerMeter;

              if (!hasStarted) {
                ctx.moveTo(px, py);
                hasStarted = true;
              } else {
                ctx.lineTo(px, py);
              }
            }
            ctx.stroke();
          }
          ctx.restore();

          // --- ĐIỂM HIỆN TẠI & TOOLTIP ---
          const curPx = originGraphX + (t - viewStartT) * pxPerSec;
          const curPy = originGraphY - currentX * pxPerMeter;

          // Kiểm tra hiển thị
          const isInsideY =
            curPy >= padding.top && curPy <= height - padding.bottom;
          const isInsideX =
            curPx >= originGraphX && curPx <= originGraphX + graphW + 2;

          if (isInsideY && isInsideX) {
            ctx.setLineDash([4, 4]);
            ctx.strokeStyle = "#94a3b8";
            ctx.lineWidth = 1;

            ctx.beginPath();

            // Gióng
            ctx.moveTo(curPx, curPy);
            ctx.lineTo(curPx, originGraphY); // Dọc xuống trục t

            ctx.moveTo(curPx, curPy);
            ctx.lineTo(originGraphX, curPy); // Ngang sang trục x

            ctx.stroke();
            ctx.setLineDash([]);

            // Chấm đỏ
            ctx.beginPath();
            ctx.fillStyle = "#dc2626";
            ctx.arc(curPx, curPy, 4, 0, Math.PI * 2);
            ctx.fill();
            ctx.strokeStyle = "#fff";
            ctx.lineWidth = 1.5;
            ctx.stroke();

            // Tooltip
            const tooltipText = `(${t.toFixed(1)}s, ${currentX.toFixed(1)}m)`;
            const textWidth = ctx.measureText(tooltipText).width;

            let tooltipX = curPx + 10;
            if (curPx + textWidth + 20 > width)
              tooltipX = curPx - textWidth - 20;

            let tooltipY = curPy - 25;
            if (curPy + 20 > height) tooltipY = curPy - 35;

            ctx.fillStyle = "rgba(30, 41, 59, 0.9)";
            ctx.roundRect(tooltipX, tooltipY, textWidth + 12, 20, 4);
            ctx.fill();

            ctx.fillStyle = "#fff";
            ctx.textAlign = "left";
            ctx.font = "10px Inter, sans-serif";
            ctx.fillText(tooltipText, tooltipX + 6, tooltipY + 14);
          } else {
            if (history.length === 0) {
              const startY = originGraphY - x0 * pxPerMeter;
              if (startY >= padding.top && startY <= height - padding.bottom) {
                ctx.beginPath();
                ctx.fillStyle = "#2563eb";
                ctx.arc(originGraphX, startY, 4, 0, Math.PI * 2);
                ctx.fill();
              }
            }
          }
        }, [history, t, currentX, x0, graphSize]);

        return (
          <div className="flex flex-col lg:h-screen min-h-screen bg-slate-100 p-2 md:p-4 font-sans text-slate-800 overflow-y-auto lg:overflow-hidden">
            {/* Header Responsive */}
            <div className="flex flex-col md:flex-row items-start md:items-center justify-between mb-4 bg-white p-3 md:p-4 rounded-xl shadow-sm border border-slate-200 gap-4 shrink-0">
              <div>
                <h1 className="text-xl md:text-2xl font-bold text-slate-800 flex items-center gap-2">
                  <IconActivity className="w-5 h-5 md:w-6 md:h-6 text-blue-600 shrink-0" />
                  <span className="truncate">DePhys</span>
                </h1>
                <div className="flex flex-wrap items-center gap-2 text-xs md:text-sm text-slate-500 mt-1">
                  <span className="bg-slate-100 px-2 py-0.5 rounded text-slate-600 font-mono">
                    Mô phỏng Chuyển động thẳng đều
                  </span>
                  <span className="hidden sm:inline">•</span>
                  <span className="hidden sm:inline">Vật lý Lớp 10</span>
                </div>
              </div>

              <div className="w-full md:w-auto flex items-center justify-between md:justify-end gap-2 md:gap-6 bg-slate-50 px-3 md:px-4 py-2 rounded-lg border border-slate-100">
                <div className="flex flex-col md:items-end">
                  <div className="text-[10px] md:text-xs font-semibold text-slate-500 uppercase tracking-wider">
                    Thời gian
                  </div>
                  <div className="text-xl md:text-2xl font-mono font-bold text-blue-600 md:w-24 text-right">
                    {t.toFixed(2)} s
                  </div>
                </div>
                <div className="w-px h-8 bg-slate-300 mx-2"></div>
                <div className="flex flex-col md:items-end">
                  <div className="text-[10px] md:text-xs font-semibold text-slate-500 uppercase tracking-wider">
                    Toạ độ (x)
                  </div>
                  <div className="text-xl md:text-2xl font-mono font-bold text-green-600 md:w-24 text-right">
                    {currentX.toFixed(2)} m
                  </div>
                </div>
              </div>
            </div>

            <div className="flex flex-col lg:flex-row gap-4 flex-1 lg:min-h-0">
              {/* CONTROL PANEL */}
              <div className="lg:w-80 bg-white p-4 md:p-6 rounded-xl shadow-sm border border-slate-200 flex flex-col gap-4 md:gap-6 lg:overflow-y-auto shrink-0">
                <div className="flex items-center gap-2 text-base md:text-lg font-bold text-slate-700 border-b border-slate-100 pb-2 md:pb-3 sticky top-0 bg-white z-10">
                  <IconSettings className="w-5 h-5 text-slate-400" />
                  <span>Thông số</span>
                </div>

                {/* Slider: x0 */}
                <div className="group">
                  <div className="flex justify-between mb-2">
                    <label className="text-sm font-semibold text-slate-600">
                      Vị trí ban đầu (x₀)
                    </label>
                    <span className="text-sm font-bold text-blue-600 bg-blue-50 px-2 rounded">
                      {x0} m
                    </span>
                  </div>
                  <input
                    type="range"
                    min="-10"
                    max="10"
                    step="1"
                    value={x0}
                    onChange={onX0Change}
                    className="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-blue-600 touch-none"
                  />
                  <div className="flex justify-between text-[10px] text-slate-400 mt-1 font-mono">
                    <span>-10</span>
                    <span>0</span>
                    <span>10</span>
                  </div>
                </div>

                {/* Slider: v */}
                <div className="group">
                  <div className="flex justify-between mb-2">
                    <label className="text-sm font-semibold text-slate-600">
                      Vận tốc (v)
                    </label>
                    <span className="text-sm font-bold text-blue-600 bg-blue-50 px-2 rounded">
                      {v} m/s
                    </span>
                  </div>
                  <input
                    type="range"
                    min="-10"
                    max="10"
                    step="1"
                    value={v}
                    onChange={onVChange}
                    className="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-blue-600 touch-none"
                  />
                  <div className="flex justify-between text-[10px] text-slate-400 mt-1 font-mono">
                    <span>-10</span>
                    <span>0</span>
                    <span>10</span>
                  </div>
                  <div className="mt-2 flex gap-2 items-start bg-yellow-50 p-2 rounded text-[10px] md:text-xs text-yellow-700">
                    <IconInfo className="w-3 h-3 mt-0.5 flex-shrink-0" />
                    <div>Nếu v {"<"} 0, vật chuyển động ngược chiều dương.</div>
                  </div>
                </div>

                {/* Phương trình Display */}
                <div className="bg-slate-800 p-3 md:p-4 rounded-lg shadow-inner text-center mt-auto md:mt-2">
                  <div className="text-[10px] text-slate-400 uppercase font-bold tracking-widest mb-1">
                    Phương trình (Tham số hiện tại)
                  </div>
                  <div className="text-lg md:text-xl font-mono text-white break-words">
                    x = {x0} {v >= 0 ? "+" : "-"} {Math.abs(v)}t
                  </div>
                </div>

                {/* Buttons */}
                <div className="grid grid-cols-2 lg:flex lg:flex-col gap-3">
                  {!isPlaying ? (
                    <button
                      onClick={() => setIsPlaying(true)}
                      className="col-span-2 lg:col-span-1 flex items-center justify-center gap-2 w-full bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white font-bold py-3 px-4 rounded-lg transition-all shadow-md hover:shadow-lg"
                    >
                      <IconPlay className="w-5 h-5 fill-current" /> Bắt đầu
                    </button>
                  ) : (
                    <button
                      onClick={() => setIsPlaying(false)}
                      className="col-span-2 lg:col-span-1 flex items-center justify-center gap-2 w-full bg-amber-500 hover:bg-amber-600 active:bg-amber-700 text-white font-bold py-3 px-4 rounded-lg transition-all shadow-md"
                    >
                      <IconPause className="w-5 h-5 fill-current" /> Tạm dừng
                    </button>
                  )}

                  <button
                    onClick={() => handleReset(null)}
                    className="col-span-2 lg:col-span-1 flex items-center justify-center gap-2 w-full bg-white border border-slate-300 hover:bg-slate-50 text-slate-700 font-semibold py-2 px-4 rounded-lg transition-colors"
                  >
                    <IconRotateCcw className="w-4 h-4" /> Đặt lại
                  </button>
                </div>
              </div>

              {/* VISUALIZATION PANEL */}
              <div className="flex-1 flex flex-col gap-4 min-h-0 lg:overflow-hidden">
                {/* Canvas 1 */}
                <div
                  ref={roadContainerRef}
                  className="h-48 lg:h-1/3 bg-white rounded-xl shadow-sm border border-slate-200 relative overflow-hidden flex flex-col shrink-0"
                >
                  <div className="absolute top-2 left-2 md:top-3 md:left-3 bg-white/90 backdrop-blur px-2 py-1 md:px-3 rounded-md text-[10px] md:text-xs font-bold text-slate-500 shadow-sm z-10 border border-slate-100 pointer-events-none">
                    Mô phỏng thực tế
                  </div>
                  <canvas
                    ref={roadCanvasRef}
                    className="w-full h-full block cursor-crosshair touch-none"
                  />
                </div>

                {/* Canvas 2 */}
                <div
                  ref={graphContainerRef}
                  className="flex-1 bg-white rounded-xl shadow-sm border border-slate-200 relative overflow-hidden flex flex-col min-h-[300px]"
                >
                  <div className="absolute top-2 left-2 md:top-3 md:left-3 bg-white/90 backdrop-blur px-2 py-1 md:px-3 rounded-md text-[10px] md:text-xs font-bold text-slate-500 shadow-sm z-10 border border-slate-100 pointer-events-none">
                    Đồ thị toạ độ - thời gian (x-t)
                  </div>
                  <canvas
                    ref={graphCanvasRef}
                    className="w-full h-full block touch-none"
                  />
                </div>
              </div>
            </div>
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<UniformMotionSim />);
    </script>

    <!-- Elfsight AI Chatbot | Untitled AI Chatbot -->
    <script src="https://elfsightcdn.com/platform.js" async></script>
    <div
      class="elfsight-app-131656ee-bb10-4a92-a766-86c412c36d15"
      data-elfsight-app-lazy
    ></div>
  </body>
</html>
